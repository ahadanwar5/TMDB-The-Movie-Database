{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import{SyntheticPlatformEmitter,CodedError}from'expo-modules-core';import{VoiceQuality}from\"./Speech.types\";var MAX_SPEECH_INPUT_LENGTH=32767;function _getVoices(){return _regeneratorRuntime.async(function getVoices$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt(\"return\",new Promise(function(resolve){var voices=window.speechSynthesis.getVoices();if(voices.length>0){resolve(voices);return;}window.speechSynthesis.onvoiceschanged=function(){var voices=window.speechSynthesis.getVoices();resolve(voices);};}));case 1:case\"end\":return _context.stop();}}},null,null,null,Promise);}export default{get name(){return'ExponentSpeech';},speak:function speak(id,text,options){return function _callee(){var message,voices,_voices;return _regeneratorRuntime.async(function _callee$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(text.length>MAX_SPEECH_INPUT_LENGTH)){_context2.next=2;break;}throw new CodedError('ERR_SPEECH_INPUT_LENGTH','Speech input text is too long! Limit of input length is: '+MAX_SPEECH_INPUT_LENGTH);case 2:message=new SpeechSynthesisUtterance();if(typeof options.rate==='number'){message.rate=options.rate;}if(typeof options.pitch==='number'){message.pitch=options.pitch;}if(typeof options.language==='string'){message.lang=options.language;}if(typeof options.volume==='number'){message.volume=options.volume;}if(!('_voiceIndex'in options&&options._voiceIndex!=null)){_context2.next=12;break;}_context2.next=10;return _regeneratorRuntime.awrap(_getVoices());case 10:voices=_context2.sent;message.voice=voices[Math.min(voices.length-1,Math.max(0,options._voiceIndex))];case 12:if(!(typeof options.voice==='string')){_context2.next=17;break;}_context2.next=15;return _regeneratorRuntime.awrap(_getVoices());case 15:_voices=_context2.sent;message.voice=_voices[Math.max(0,_voices.findIndex(function(voice){return voice.voiceURI===options.voice;}))];case 17:if(typeof options.onResume==='function'){message.onresume=options.onResume;}if(typeof options.onMark==='function'){message.onmark=options.onMark;}if(typeof options.onBoundary==='function'){message.onboundary=options.onBoundary;}message.onstart=function(nativeEvent){SyntheticPlatformEmitter.emit('Exponent.speakingStarted',{id:id,nativeEvent:nativeEvent});};message.onend=function(nativeEvent){SyntheticPlatformEmitter.emit('Exponent.speakingDone',{id:id,nativeEvent:nativeEvent});};message.onpause=function(nativeEvent){SyntheticPlatformEmitter.emit('Exponent.speakingStopped',{id:id,nativeEvent:nativeEvent});};message.onerror=function(nativeEvent){SyntheticPlatformEmitter.emit('Exponent.speakingError',{id:id,nativeEvent:nativeEvent});};message.text=text;window.speechSynthesis.speak(message);return _context2.abrupt(\"return\",message);case 27:case\"end\":return _context2.stop();}}},null,null,null,Promise);}();},getVoices:function getVoices(){return function _callee2(){var voices;return _regeneratorRuntime.async(function _callee2$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(_getVoices());case 2:voices=_context3.sent;return _context3.abrupt(\"return\",voices.map(function(voice){return{identifier:voice.voiceURI,quality:VoiceQuality.Default,isDefault:voice.default,language:voice.lang,localService:voice.localService,name:voice.name,voiceURI:voice.voiceURI};}));case 4:case\"end\":return _context3.stop();}}},null,null,null,Promise);}();},isSpeaking:function isSpeaking(){return function _callee3(){return _regeneratorRuntime.async(function _callee3$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",window.speechSynthesis.speaking);case 1:case\"end\":return _context4.stop();}}},null,null,null,Promise);}();},stop:function stop(){return function _callee4(){return _regeneratorRuntime.async(function _callee4$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",window.speechSynthesis.cancel());case 1:case\"end\":return _context5.stop();}}},null,null,null,Promise);}();},pause:function pause(){return function _callee5(){return _regeneratorRuntime.async(function _callee5$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:return _context6.abrupt(\"return\",window.speechSynthesis.pause());case 1:case\"end\":return _context6.stop();}}},null,null,null,Promise);}();},resume:function resume(){return function _callee6(){return _regeneratorRuntime.async(function _callee6$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",window.speechSynthesis.resume());case 1:case\"end\":return _context7.stop();}}},null,null,null,Promise);}();},maxSpeechInputLength:MAX_SPEECH_INPUT_LENGTH};","map":{"version":3,"names":["SyntheticPlatformEmitter","CodedError","VoiceQuality","MAX_SPEECH_INPUT_LENGTH","getVoices","_regeneratorRuntime","async","getVoices$","_context","prev","next","abrupt","Promise","resolve","voices","window","speechSynthesis","length","onvoiceschanged","stop","name","speak","id","text","options","_callee","message","_voices","_callee$","_context2","SpeechSynthesisUtterance","rate","pitch","language","lang","volume","_voiceIndex","awrap","sent","voice","Math","min","max","findIndex","voiceURI","onResume","onresume","onMark","onmark","onBoundary","onboundary","onstart","nativeEvent","emit","onend","onpause","onerror","_callee2","_callee2$","_context3","map","identifier","quality","Default","isDefault","default","localService","isSpeaking","_callee3","_callee3$","_context4","speaking","_callee4","_callee4$","_context5","cancel","pause","_callee5","_callee5$","_context6","resume","_callee6","_callee6$","_context7","maxSpeechInputLength"],"sources":["/Users/ahadanwar/Desktop/tmdb/node_modules/expo-speech/src/Speech/ExponentSpeech.web.ts"],"sourcesContent":["import { SyntheticPlatformEmitter, CodedError } from 'expo-modules-core';\n\nimport { SpeechOptions, WebVoice, VoiceQuality } from './Speech.types';\n\n//https://developer.mozilla.org/en-US/docs/Web/API/SpeechSynthesisUtterance/text\nconst MAX_SPEECH_INPUT_LENGTH = 32767;\n\nasync function getVoices(): Promise<SpeechSynthesisVoice[]> {\n  return new Promise<SpeechSynthesisVoice[]>((resolve) => {\n    const voices = window.speechSynthesis.getVoices();\n\n    if (voices.length > 0) {\n      resolve(voices);\n      return;\n    }\n\n    // when a page loads it takes some amount of time to populate the voices list\n    // see https://stackoverflow.com/a/52005323/4337317\n    window.speechSynthesis.onvoiceschanged = function () {\n      const voices = window.speechSynthesis.getVoices();\n      resolve(voices);\n    };\n  });\n}\n\nexport default {\n  get name(): string {\n    return 'ExponentSpeech';\n  },\n  async speak(id: string, text: string, options: SpeechOptions): Promise<SpeechSynthesisUtterance> {\n    if (text.length > MAX_SPEECH_INPUT_LENGTH) {\n      throw new CodedError(\n        'ERR_SPEECH_INPUT_LENGTH',\n        'Speech input text is too long! Limit of input length is: ' + MAX_SPEECH_INPUT_LENGTH\n      );\n    }\n\n    const message = new SpeechSynthesisUtterance();\n\n    if (typeof options.rate === 'number') {\n      message.rate = options.rate;\n    }\n    if (typeof options.pitch === 'number') {\n      message.pitch = options.pitch;\n    }\n    if (typeof options.language === 'string') {\n      message.lang = options.language;\n    }\n    if (typeof options.volume === 'number') {\n      message.volume = options.volume;\n    }\n    if ('_voiceIndex' in options && options._voiceIndex != null) {\n      const voices = await getVoices();\n      message.voice = voices[Math.min(voices.length - 1, Math.max(0, options._voiceIndex))];\n    }\n    if (typeof options.voice === 'string') {\n      const voices = await getVoices();\n      message.voice =\n        voices[\n          Math.max(\n            0,\n            voices.findIndex((voice) => voice.voiceURI === options.voice)\n          )\n        ];\n    }\n    if (typeof options.onResume === 'function') {\n      message.onresume = options.onResume;\n    }\n    if (typeof options.onMark === 'function') {\n      message.onmark = options.onMark;\n    }\n    if (typeof options.onBoundary === 'function') {\n      message.onboundary = options.onBoundary;\n    }\n\n    message.onstart = (nativeEvent: SpeechSynthesisEvent) => {\n      SyntheticPlatformEmitter.emit('Exponent.speakingStarted', { id, nativeEvent });\n    };\n    message.onend = (nativeEvent: SpeechSynthesisEvent) => {\n      SyntheticPlatformEmitter.emit('Exponent.speakingDone', { id, nativeEvent });\n    };\n    message.onpause = (nativeEvent: SpeechSynthesisEvent) => {\n      SyntheticPlatformEmitter.emit('Exponent.speakingStopped', { id, nativeEvent });\n    };\n    message.onerror = (nativeEvent: SpeechSynthesisErrorEvent) => {\n      SyntheticPlatformEmitter.emit('Exponent.speakingError', { id, nativeEvent });\n    };\n\n    message.text = text;\n\n    window.speechSynthesis.speak(message);\n\n    return message;\n  },\n  async getVoices(): Promise<WebVoice[]> {\n    const voices = await getVoices();\n    return voices.map((voice) => ({\n      identifier: voice.voiceURI,\n      quality: VoiceQuality.Default,\n      isDefault: voice.default,\n      language: voice.lang,\n      localService: voice.localService,\n      name: voice.name,\n      voiceURI: voice.voiceURI,\n    }));\n  },\n  async isSpeaking(): Promise<boolean> {\n    return window.speechSynthesis.speaking;\n  },\n  async stop(): Promise<void> {\n    return window.speechSynthesis.cancel();\n  },\n  async pause(): Promise<void> {\n    return window.speechSynthesis.pause();\n  },\n  async resume(): Promise<void> {\n    return window.speechSynthesis.resume();\n  },\n  maxSpeechInputLength: MAX_SPEECH_INPUT_LENGTH,\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}